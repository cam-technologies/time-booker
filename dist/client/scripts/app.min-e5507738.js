/**
 * Time Booker v0.0.0 (https://github.com/cam-technologies/time-booker)
 * Copyright 2014(c) C.A.M. Technologies
 * Licensed under MIT
 */
Ember.TEMPLATES.application=Ember.Handlebars.template(function(e,t,s,n,a){function r(e,t){t.buffer.push("Articles")}function o(e,t){t.buffer.push("Photos")}function h(e,t){t.buffer.push("Login")}this.compilerInfo=[4,">= 1.0.0"],s=this.merge(s,Ember.Handlebars.helpers),a=a||{};var l,i,p,u="",c=this,f=s.helperMissing;return a.buffer.push('<div class="container">\n    <div class="navbar navbar-default">\n        <div class="navbar-inner">\n            <a class="navbar-brand" href="#">Ember Digest</a>\n            <ul class="nav navbar-nav pull-right">\n                <li>'),i=s["link-to"]||t&&t["link-to"],p={hash:{},hashTypes:{},hashContexts:{},inverse:c.noop,fn:c.program(1,r,a),contexts:[t],types:["STRING"],data:a},l=i?i.call(t,"articles",p):f.call(t,"link-to","articles",p),(l||0===l)&&a.buffer.push(l),a.buffer.push("</li>\n                <li>"),i=s["link-to"]||t&&t["link-to"],p={hash:{},hashTypes:{},hashContexts:{},inverse:c.noop,fn:c.program(3,o,a),contexts:[t],types:["STRING"],data:a},l=i?i.call(t,"photos",p):f.call(t,"link-to","photos",p),(l||0===l)&&a.buffer.push(l),a.buffer.push("</li>\n                <li>"),i=s["link-to"]||t&&t["link-to"],p={hash:{},hashTypes:{},hashContexts:{},inverse:c.noop,fn:c.program(5,h,a),contexts:[t],types:["STRING"],data:a},l=i?i.call(t,"login",p):f.call(t,"link-to","login",p),(l||0===l)&&a.buffer.push(l),a.buffer.push("</li>\n            </ul>\n        </div>\n    </div>\n\n    "),l=s._triageMustache.call(t,"outlet",{hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["ID"],data:a}),(l||0===l)&&a.buffer.push(l),a.buffer.push("\n</div>"),u}),Ember.TEMPLATES.articles=Ember.Handlebars.template(function(e,t,s,n,a){function r(e,t){var n,a="";return t.buffer.push("\n    <article>\n        <h3>"),n=s._triageMustache.call(e,"title",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(n||0===n)&&t.buffer.push(n),t.buffer.push("</h3>\n        <p>Posted by "),n=s._triageMustache.call(e,"author",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(n||0===n)&&t.buffer.push(n),t.buffer.push("</p>\n        <p>"),n=s._triageMustache.call(e,"body",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(n||0===n)&&t.buffer.push(n),t.buffer.push("</p>\n    </article>\n"),a}this.compilerInfo=[4,">= 1.0.0"],s=this.merge(s,Ember.Handlebars.helpers),a=a||{};var o,h="",l=this;return a.buffer.push("<h2>Articles</h2>\n\n"),o=s.each.call(t,"model",{hash:{},hashTypes:{},hashContexts:{},inverse:l.noop,fn:l.program(1,r,a),contexts:[t],types:["ID"],data:a}),(o||0===o)&&a.buffer.push(o),h}),Ember.TEMPLATES.index=Ember.Handlebars.template(function(e,t,s,n,a){this.compilerInfo=[4,">= 1.0.0"],s=this.merge(s,Ember.Handlebars.helpers),a=a||{},a.buffer.push("<h1>Welcome to Ember Digest</h1>\n<p>Here we got all sorts of content!</p>")}),Ember.TEMPLATES.login=Ember.Handlebars.template(function(e,t,s,n,a){function r(e,t){t.buffer.push("\n    <p>You are already logged in!</p>\n")}function o(e,t){var n,a,r,o="";return t.buffer.push('\n    <form class="form-inline" '),t.buffer.push(i(s.action.call(e,"login",{hash:{on:"submit"},hashTypes:{on:"STRING"},hashContexts:{on:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push(">\n        <h2>Log In</h2>\n        "),t.buffer.push(i((a=s.input||e&&e.input,r={hash:{value:"username",type:"text",placeholder:"Username"},hashTypes:{value:"ID",type:"STRING",placeholder:"STRING"},hashContexts:{value:e,type:e,placeholder:e},contexts:[],types:[],data:t},a?a.call(e,r):p.call(e,"input",r)))),t.buffer.push("\n        "),t.buffer.push(i((a=s.input||e&&e.input,r={hash:{value:"password",type:"password",placeholder:"Password"},hashTypes:{value:"ID",type:"STRING",placeholder:"STRING"},hashContexts:{value:e,type:e,placeholder:e},contexts:[],types:[],data:t},a?a.call(e,r):p.call(e,"input",r)))),t.buffer.push("\n        "),t.buffer.push(i((a=s.input||e&&e.input,r={hash:{"class":"btn",type:"submit",value:"Log In"},hashTypes:{"class":"STRING",type:"STRING",value:"STRING"},hashContexts:{"class":e,type:e,value:e},contexts:[],types:[],data:t},a?a.call(e,r):p.call(e,"input",r)))),t.buffer.push("\n    </form>\n    "),n=s["if"].call(e,"errorMessage",{hash:{},hashTypes:{},hashContexts:{},inverse:u.noop,fn:u.program(4,h,t),contexts:[e],types:["ID"],data:t}),(n||0===n)&&t.buffer.push(n),t.buffer.push("\n"),o}function h(e,t){var n,a="";return t.buffer.push('\n        <div class="alert alert-error">'),n=s._triageMustache.call(e,"errorMessage",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(n||0===n)&&t.buffer.push(n),t.buffer.push("</div>\n    "),a}this.compilerInfo=[4,">= 1.0.0"],s=this.merge(s,Ember.Handlebars.helpers),a=a||{};var l,i=this.escapeExpression,p=s.helperMissing,u=this;l=s["if"].call(t,"loggedIn",{hash:{},hashTypes:{},hashContexts:{},inverse:u.program(3,o,a),fn:u.program(1,r,a),contexts:[t],types:["ID"],data:a}),a.buffer.push(l||0===l?l:"")}),Ember.TEMPLATES.photos=Ember.Handlebars.template(function(e,t,s,n,a){function r(e,t){var n="";return t.buffer.push('\n            <li class="col-xs-6 col-md-3">\n                        <span class="thumbnail">\n                          <img '),t.buffer.push(l(s["bind-attr"].call(e,{hash:{src:"src"},hashTypes:{src:"STRING"},hashContexts:{src:e},contexts:[],types:[],data:t}))),t.buffer.push(" />\n                        </span>\n            </li>\n        "),n}this.compilerInfo=[4,">= 1.0.0"],s=this.merge(s,Ember.Handlebars.helpers),a=a||{};var o,h="",l=this.escapeExpression,i=this;return a.buffer.push('<h2>Photos</h2>\n\n<div class="row">\n    <ul id="photos" class="thumbnails">\n        '),o=s.each.call(t,"model",{hash:{},hashTypes:{},hashContexts:{},inverse:i.noop,fn:i.program(1,r,a),contexts:[t],types:["ID"],data:a}),(o||0===o)&&a.buffer.push(o),a.buffer.push("\n    </ul>\n</div>"),h}),window.App=Ember.Application.create({LOG_TRANSITIONS:!0,DEBUG:!0,LOG_VIEW_LOOKUPS:!0}),App.Router.map(function(){this.route("articles",{path:"/articles"}),this.route("photos",{path:"/photos"}),this.route("login",{path:"/login"})}),App.LoginController=Ember.Controller.extend({actions:{login:function(){var e=this,t=this.getProperties("username","password");this.set("errorMessage",null),$.post("/auth.json",t).then(function(t){if(e.set("errorMessage",t.message),t.success){alert("Login succeeded!"),e.set("token",t.token);var s=e.get("attemptedTransition");s?(s.retry(),e.set("attemptedTransition",null)):e.transitionToRoute("articles")}})}},reset:function(){this.setProperties({username:"",password:"",errorMessage:""})},token:localStorage.token,tokenChanged:function(){localStorage.token=this.get("token")}.observes("token")}),App.AuthenticatedRoute=Ember.Route.extend({beforeModel:function(e){this.controllerFor("login").get("token")||this.redirectToLogin(e)},redirectToLogin:function(e){alert("You must log in!");var t=this.controllerFor("login");t.set("attemptedTransition",e),this.transitionTo("login")},getJSONWithToken:function(e){var t=this.controllerFor("login").get("token");return $.getJSON(e,{token:t})},actions:{error:function(e,t){401===e.status?this.redirectToLogin(t):alert("Something went wrong")}}}),App.PhotosRoute=App.AuthenticatedRoute.extend({model:function(){return this.getJSONWithToken("/photos.json")}}),App.ArticlesRoute=App.AuthenticatedRoute.extend({model:function(){return this.getJSONWithToken("/articles.json")}}),App.LoginRoute=Ember.Route.extend({setupController:function(e){e.reset()}});